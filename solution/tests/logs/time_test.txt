time="2025-02-21T23:42:37+03:00" level=warning msg="/home/ainur/projects/prod-ind/solution/docker-compose.test.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
app-test-1  | 2025/02/21 20:42:37 success
app-test-1  | [Fx] PROVIDE	fx.Lifecycle <= go.uber.org/fx.New.func1()
app-test-1  | [Fx] PROVIDE	fx.Shutdowner <= go.uber.org/fx.(*App).shutdowner-fm()
app-test-1  | [Fx] PROVIDE	fx.DotGraph <= go.uber.org/fx.(*App).dotGraph-fm()
app-test-1  | [Fx] PROVIDE	config.HTTPConfig <= server/internal/config.NewHTTPConfig() from module "http-server"
app-test-1  | [Fx] PROVIDE	*http.Server <= server/internal/transport/http.NewServer() from module "http-server"
app-test-1  | [Fx] PROVIDE	config.PostgresConfig <= server/internal/config.NewPostgresConfig() from module "postgres-client"
app-test-1  | [Fx] PROVIDE	*gorm.DB <= server/pkg/client/postgres.NewPostgresClient() from module "postgres-client"
app-test-1  | [Fx] PROVIDE	config.RedisConfig <= server/internal/config.NewRedisConfig() from module "redis-client"
app-test-1  | [Fx] PROVIDE	*redis.Client <= server/pkg/client/redis.NewRedisClient() from module "redis-client"
app-test-1  | [Fx] PROVIDE	config.YandexGptConfig <= server/internal/config.NewYandexGptConfig() from module "gpt-http"
app-test-1  | [Fx] PROVIDE	gpt.YandexGptClient <= server/pkg/client/yandex-cloud/gpt/http.NewClient() from module "gpt-http"
app-test-1  | [Fx] PROVIDE	config.PerspectiveConfig <= server/internal/config.NewPerspectiveConfig() from module "moderator-http"
app-test-1  | [Fx] PROVIDE	moderator.Moderator <= server/pkg/client/google/moderator/http.NewClient() from module "moderator-http"
app-test-1  | [Fx] PROVIDE	service.AiService <= server/internal/service/ai.NewAiService() from module "ai-service"
app-test-1  | [Fx] PROVIDE	repository.CampaignObjectRepository <= server/internal/repository/campaign_object/mock.NewCampaignObjectRepository() from module "campaign-object-mock-repository"
app-test-1  | [Fx] PROVIDE	repository.ClientRepository <= server/internal/repository/client.NewClientRepository() from module "repository-client"
app-test-1  | [Fx] PROVIDE	service.ClientService <= server/internal/service/client.NewClientService() from module "service-client"
app-test-1  | [Fx] PROVIDE	repository.AdvertiserRepository <= server/internal/repository/advertiser.NewAdvertiserRepository() from module "advertiser-repository"
app-test-1  | [Fx] PROVIDE	service.AdvertiserService <= server/internal/service/advertiser.NewAdvertiserService() from module "advertiser-service"
app-test-1  | [Fx] PROVIDE	repository.CampaignRepository <= server/internal/repository/campaign.NewCampaignRepository() from module "campaign-repository"
app-test-1  | [Fx] PROVIDE	service.CampaignService <= server/internal/service/campaign.NewCampaignService() from module "campaign-service"
app-test-1  | [Fx] PROVIDE	repository.TimeRepository <= server/internal/repository/time.NewTimeRepository() from module "repository-time"
app-test-1  | [Fx] PROVIDE	service.TimeService <= server/internal/service/time.NewTimeService() from module "time-service"
app-test-1  | [Fx] PROVIDE	repository.AdsRepsitory <= server/internal/repository/ads.NewAdsRepository() from module "ads-repository"
app-test-1  | [Fx] PROVIDE	service.AdsService <= server/internal/service/ads.NewAdsService() from module "ads-service"
app-test-1  | [Fx] PROVIDE	repository.StatRepository <= server/internal/repository/stat.NewStatRepository() from module "stat-repository"
app-test-1  | [Fx] PROVIDE	service.StatService <= server/internal/service/stat.NewStatService() from module "stat-service"
app-test-1  | [Fx] INVOKE		server/internal/transport/http.NewModule.func1() from module "http-server"
app-test-1  | [Fx] RUN	provide: go.uber.org/fx.New.func1() in 6.273Âµs
app-test-1  | [Fx] RUN	provide: server/internal/config.NewHTTPConfig() in 7.019Âµs from module "http-server"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewPostgresConfig() in 7.901Âµs from module "postgres-client"
app-test-1  | POSTGRES_DSN: postgres://postgres:postgres@postgres-test:5432/postgres?sslmode=disable
app-test-1  | [Fx] RUN	provide: server/pkg/client/postgres.NewPostgresClient() in 4.870709ms from module "postgres-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/client.NewClientRepository() in 8.454Âµs from module "repository-client"
app-test-1  | [Fx] RUN	provide: server/internal/service/client.NewClientService() in 7.644Âµs from module "service-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/advertiser.NewAdvertiserRepository() in 9.109Âµs from module "advertiser-repository"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewYandexGptConfig() in 25.723Âµs from module "gpt-http"
app-test-1  | [Fx] RUN	provide: server/pkg/client/yandex-cloud/gpt/http.NewClient() in 4.58Âµs from module "gpt-http"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewPerspectiveConfig() in 10.212Âµs from module "moderator-http"
app-test-1  | [Fx] RUN	provide: server/pkg/client/google/moderator/http.NewClient() in 8.488Âµs from module "moderator-http"
app-test-1  | [Fx] RUN	provide: server/internal/service/ai.NewAiService() in 4.169Âµs from module "ai-service"
app-test-1  | [Fx] RUN	provide: server/internal/service/advertiser.NewAdvertiserService() in 4.051Âµs from module "advertiser-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/campaign.NewCampaignRepository() in 6.103Âµs from module "campaign-repository"
app-test-1  | [Fx] RUN	provide: server/internal/repository/campaign_object/mock.NewCampaignObjectRepository() in 5.292Âµs from module "campaign-object-mock-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/campaign.NewCampaignService() in 21.506Âµs from module "campaign-service"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewRedisConfig() in 13.82Âµs from module "redis-client"
app-test-1  | [Fx] RUN	provide: server/pkg/client/redis.NewRedisClient() in 561.163Âµs from module "redis-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/time.NewTimeRepository() in 11.597Âµs from module "repository-time"
app-test-1  | [Fx] RUN	provide: server/internal/service/time.NewTimeService() in 60.491Âµs from module "time-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/ads.NewAdsRepository() in 5.303Âµs from module "ads-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/ads.NewAdsService() in 2.946Âµs from module "ads-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/stat.NewStatRepository() in 2.766Âµs from module "stat-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/stat.NewStatService() in 5.699Âµs from module "stat-service"
app-test-1  | [Fx] RUN	provide: server/internal/transport/http.NewServer() in 42.823Âµs from module "http-server"
app-test-1  | [Fx] HOOK OnStart		server/internal/transport/http.NewModule.func1.1() executing (caller: server/internal/transport/http.NewModule.func1)
app-test-1  | 2025-02-21T20:42:37.254Z	[35mDEBUG[0m	starting http server
app-test-1  | 
app-test-1  | [Fx] HOOK OnStart		server/internal/transport/http.NewModule.func1.1() called by server/internal/transport/http.NewModule.func1 ran successfully in 129.079Âµs
app-test-1  |    ____    __
app-test-1  | [Fx] RUNNING
app-test-1  |   / __/___/ /  ___
app-test-1  |  / _// __/ _ \/ _ \
app-test-1  | /___/\__/_//_/\___/ v4.13.3
app-test-1  | High performance, minimalist Go web framework
app-test-1  | https://echo.labstack.com
app-test-1  | ____________________________________O/_______
app-test-1  |                                     O\
app-test-1  | â‡¨ http server started on [::]:8081
app-test-1  | 2025-02-21T20:42:42.218Z	[34mINFO[0m	Time was set	{"day": 53}
app-test-1  | 2025-02-21T20:42:42.222Z	[31mERROR[0m	["invalid day"]	{"error_type": "validation_error"}
app-test-1  | [Fx] TERMINATED
app-test-1  | [Fx] HOOK OnStop		server/internal/transport/http.NewModule.func1.2() executing (caller: server/internal/transport/http.NewModule.func1)
app-test-1  | 2025/02/21 20:42:42 http: Server closed
[Kapp-test-1 exited with code 0
app-test-1  | no changes
app-test-1  | [Fx] PROVIDE	fx.Lifecycle <= go.uber.org/fx.New.func1()
app-test-1  | [Fx] PROVIDE	fx.Shutdowner <= go.uber.org/fx.(*App).shutdowner-fm()
app-test-1  | [Fx] PROVIDE	fx.DotGraph <= go.uber.org/fx.(*App).dotGraph-fm()
app-test-1  | [Fx] PROVIDE	config.HTTPConfig <= server/internal/config.NewHTTPConfig() from module "http-server"
app-test-1  | [Fx] PROVIDE	*http.Server <= server/internal/transport/http.NewServer() from module "http-server"
app-test-1  | [Fx] PROVIDE	config.PostgresConfig <= server/internal/config.NewPostgresConfig() from module "postgres-client"
app-test-1  | [Fx] PROVIDE	*gorm.DB <= server/pkg/client/postgres.NewPostgresClient() from module "postgres-client"
app-test-1  | [Fx] PROVIDE	config.RedisConfig <= server/internal/config.NewRedisConfig() from module "redis-client"
app-test-1  | [Fx] PROVIDE	*redis.Client <= server/pkg/client/redis.NewRedisClient() from module "redis-client"
app-test-1  | [Fx] PROVIDE	config.YandexGptConfig <= server/internal/config.NewYandexGptConfig() from module "gpt-http"
app-test-1  | [Fx] PROVIDE	gpt.YandexGptClient <= server/pkg/client/yandex-cloud/gpt/http.NewClient() from module "gpt-http"
app-test-1  | [Fx] PROVIDE	config.PerspectiveConfig <= server/internal/config.NewPerspectiveConfig() from module "moderator-http"
app-test-1  | [Fx] PROVIDE	moderator.Moderator <= server/pkg/client/google/moderator/http.NewClient() from module "moderator-http"
app-test-1  | [Fx] PROVIDE	service.AiService <= server/internal/service/ai.NewAiService() from module "ai-service"
app-test-1  | [Fx] PROVIDE	repository.CampaignObjectRepository <= server/internal/repository/campaign_object/mock.NewCampaignObjectRepository() from module "campaign-object-mock-repository"
app-test-1  | [Fx] PROVIDE	repository.ClientRepository <= server/internal/repository/client.NewClientRepository() from module "repository-client"
app-test-1  | [Fx] PROVIDE	service.ClientService <= server/internal/service/client.NewClientService() from module "service-client"
app-test-1  | [Fx] PROVIDE	repository.AdvertiserRepository <= server/internal/repository/advertiser.NewAdvertiserRepository() from module "advertiser-repository"
app-test-1  | [Fx] PROVIDE	service.AdvertiserService <= server/internal/service/advertiser.NewAdvertiserService() from module "advertiser-service"
app-test-1  | [Fx] PROVIDE	repository.CampaignRepository <= server/internal/repository/campaign.NewCampaignRepository() from module "campaign-repository"
app-test-1  | [Fx] PROVIDE	service.CampaignService <= server/internal/service/campaign.NewCampaignService() from module "campaign-service"
app-test-1  | [Fx] PROVIDE	repository.TimeRepository <= server/internal/repository/time.NewTimeRepository() from module "repository-time"
app-test-1  | [Fx] PROVIDE	service.TimeService <= server/internal/service/time.NewTimeService() from module "time-service"
app-test-1  | [Fx] PROVIDE	repository.AdsRepsitory <= server/internal/repository/ads.NewAdsRepository() from module "ads-repository"
app-test-1  | [Fx] PROVIDE	service.AdsService <= server/internal/service/ads.NewAdsService() from module "ads-service"
app-test-1  | [Fx] PROVIDE	repository.StatRepository <= server/internal/repository/stat.NewStatRepository() from module "stat-repository"
app-test-1  | [Fx] PROVIDE	service.StatService <= server/internal/service/stat.NewStatService() from module "stat-service"
app-test-1  | [Fx] INVOKE		server/internal/transport/http.NewModule.func1() from module "http-server"
app-test-1  | [Fx] RUN	provide: go.uber.org/fx.New.func1() in 6.187Âµs
app-test-1  | [Fx] RUN	provide: server/internal/config.NewHTTPConfig() in 6.021Âµs from module "http-server"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewPostgresConfig() in 7.109Âµs from module "postgres-client"
app-test-1  | POSTGRES_DSN: postgres://postgres:postgres@postgres-test:5432/postgres?sslmode=disable
app-test-1  | [Fx] RUN	provide: server/pkg/client/postgres.NewPostgresClient() in 4.370277ms from module "postgres-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/client.NewClientRepository() in 6.448Âµs from module "repository-client"
app-test-1  | [Fx] RUN	provide: server/internal/service/client.NewClientService() in 10.999Âµs from module "service-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/advertiser.NewAdvertiserRepository() in 2.869Âµs from module "advertiser-repository"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewYandexGptConfig() in 17.347Âµs from module "gpt-http"
app-test-1  | [Fx] RUN	provide: server/pkg/client/yandex-cloud/gpt/http.NewClient() in 3.837Âµs from module "gpt-http"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewPerspectiveConfig() in 5.148Âµs from module "moderator-http"
app-test-1  | [Fx] RUN	provide: server/pkg/client/google/moderator/http.NewClient() in 7.166Âµs from module "moderator-http"
app-test-1  | [Fx] RUN	provide: server/internal/service/ai.NewAiService() in 4.587Âµs from module "ai-service"
app-test-1  | [Fx] RUN	provide: server/internal/service/advertiser.NewAdvertiserService() in 3.562Âµs from module "advertiser-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/campaign.NewCampaignRepository() in 3.318Âµs from module "campaign-repository"
app-test-1  | [Fx] RUN	provide: server/internal/repository/campaign_object/mock.NewCampaignObjectRepository() in 4.195Âµs from module "campaign-object-mock-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/campaign.NewCampaignService() in 6.323Âµs from module "campaign-service"
app-test-1  | [Fx] RUN	provide: server/internal/config.NewRedisConfig() in 14.821Âµs from module "redis-client"
app-test-1  | [Fx] RUN	provide: server/pkg/client/redis.NewRedisClient() in 364.871Âµs from module "redis-client"
app-test-1  | [Fx] RUN	provide: server/internal/repository/time.NewTimeRepository() in 4.411Âµs from module "repository-time"
app-test-1  | [Fx] RUN	provide: server/internal/service/time.NewTimeService() in 46.03Âµs from module "time-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/ads.NewAdsRepository() in 9.841Âµs from module "ads-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/ads.NewAdsService() in 2.427Âµs from module "ads-service"
app-test-1  | [Fx] RUN	provide: server/internal/repository/stat.NewStatRepository() in 5.077Âµs from module "stat-repository"
app-test-1  | [Fx] RUN	provide: server/internal/service/stat.NewStatService() in 4.131Âµs from module "stat-service"
app-test-1  | [Fx] RUN	provide: server/internal/transport/http.NewServer() in 27.798Âµs from module "http-server"
app-test-1  | [Fx] HOOK OnStart		server/internal/transport/http.NewModule.func1.1() executing (caller: server/internal/transport/http.NewModule.func1)
app-test-1  | 2025-02-21T20:42:42.557Z	[35mDEBUG[0m	starting http server
app-test-1  | [Fx] HOOK OnStart		server/internal/transport/http.NewModule.func1.1() called by server/internal/transport/http.NewModule.func1 ran successfully in 18.511Âµs
app-test-1  | [Fx] RUNNING
app-test-1  | 
app-test-1  |    ____    __
app-test-1  |   / __/___/ /  ___
app-test-1  |  / _// __/ _ \/ _ \
app-test-1  | /___/\__/_//_/\___/ v4.13.3
app-test-1  | High performance, minimalist Go web framework
app-test-1  | https://echo.labstack.com
app-test-1  | ____________________________________O/_______
app-test-1  |                                     O\
app-test-1  | â‡¨ http server started on [::]:8081
app-test-1  | [Fx] TERMINATED
app-test-1  | [Fx] HOOK OnStop		server/internal/transport/http.NewModule.func1.2() executing (caller: server/internal/transport/http.NewModule.func1)
app-test-1  | 2025/02/21 20:42:47 http: Server closed
